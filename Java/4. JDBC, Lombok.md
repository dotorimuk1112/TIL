# JDBC, Lombok

ë¶„ë¥˜: Java

# âœ… Spring Tool Suite ì„¤ì¹˜

<aside>
ğŸ’¡ STS
ì• í”Œë¦¬ì¼€ì´ì…˜ êµ¬ì¶•ì— ë„ë¦¬ ì‚¬ìš©ë˜ëŠ” Java í”„ë ˆì„ì›Œí¬ì¸ Spring í”„ë ˆì„ì›Œí¬ë¥¼ ê¸°ë°˜ìœ¼ë¡œ, ê°œë°œì„ ìœ„í•´ ì„¤ê³„ëœ IDE.
STSëŠ” Spring ê¸°ë°˜ í”„ë¡œì íŠ¸ ì‘ì—… ì‹œ í”„ë¡œì„¸ìŠ¤ë¥¼ ê°„ì†Œí™”í•˜ê³  ìƒì‚°ì„±ì„ í–¥ìƒì‹œí‚¤ëŠ” ë„êµ¬ ë° ê¸°ëŠ¥ì„ ë‹¤ìˆ˜ ì œê³µ

</aside>

[Tools](https://spring.io/tools/)

- Java ì‘ì—… ë””ë ‰í† ë¦¬ì— STSë¥¼ ì„¤ì¹˜í•œë‹¤.
- ì„¤ì¹˜ í›„ ê¸°ì¡´ì— ì‚¬ìš©í•˜ë˜ ì´í´ë¦½ìŠ¤ê°€ ì•„ë‹Œ STS.exeë¡œ ì´í´ë¦½ìŠ¤ë¥¼ ì‹¤í–‰í•œë‹¤.

# âœ… Maven

<aside>
ğŸ’¡ **Maven**
Mavenì€ ì—¬ëŸ¬ ì™¸ë¶€ ë¼ì´ë¸ŒëŸ¬ë¦¬ ë° ìë°” ë²„ì „ ë“±ì„ ê´€ë¦¬í•´ì£¼ê¸° ìœ„í•œ í•œ ë°©ë²•ì´ë‹¤.
í”„ë¡œì íŠ¸ì˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ ë²„ì „ì´ë‚˜ ì¢…ì†ì„± ê´€ë¦¬ë¥¼ ì‰½ê²Œ ë„ì™€ì¤€ë‹¤.
Ant, Gradle ë“±ì´ ê°™ì€ ì—­í• ì„ í•˜ì§€ë§Œ Mavenì´ ë†’ì€ ì ìœ ìœ¨ì„ ë³´ì´ê³  ìˆë‹¤.
êµ³ì´ ë¹„êµí•˜ìë©´ PIP(Package Installer of Python)ê³¼ ë¹„ìŠ·í•œ ì—­í• ì„ í•œë‹¤.

ì—¬ëŸ¬ ë™ë£Œë“¤ê³¼ í˜‘ì—…í•˜ê¸° ìœ„í•´ì„œëŠ” ì¢…ì†ì„± ê´€ë¦¬ê°€ í•„ìˆ˜ì´ë©°, Mavenì€ ì—¬ëŸ¬ëª¨ë¡œ ê°œë°œ í”„ë¡œì„¸ìŠ¤ë¥¼ í¸ë¦¬í™”, ê°„ì†Œí™”í•´ì¤€ë‹¤.

</aside>

## â–  Mavenì˜ íŠ¹ì§•

- **ê°„í¸í•œ êµ¬ì„±**
    - XML íŒŒì¼ì„ ì‚¬ìš©í•˜ì—¬ ê°„ë‹¨í•˜ë‹¤.
        - Extension Markup Language
        - **Maven XML íŒŒì¼(MySQL JDBC ë“œë¼ì´ë²„ì™€ Lombokì„ ì¶”ê°€)**
            
            ```xml
            <project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
              <modelVersion>4.0.0</modelVersion>
              <groupId>groupID</groupId>
              <artifactId>day06Jdbc</artifactId>
              <version>0.0.1-SNAPSHOT</version>
              <build>
                <sourceDirectory>src</sourceDirectory>
                <plugins>
                  <plugin>
                    <artifactId>maven-compiler-plugin</artifactId>
                    <version>3.8.1</version>
                    <configuration>
                      <release>17</release>
                    </configuration>
                  </plugin>
                </plugins>
              </build>
              
              <!-- ì „ì²´ ì¢…ì†ì„±ì„ ì¶”ê°€í•˜ê¸° ìœ„í•œ íƒ­-->
              <dependencies>
                  <!-- https://mvnrepository.com/artifact/mysql/mysql-connector-java -->
            		  <!-- ì¢…ì†ì„± 1-->
            		<dependency>
            		    <groupId>mysql</groupId>
            		    <artifactId>mysql-connector-java</artifactId>
            		    <version>8.0.28</version>
            		</dependency>
            		<!-- https://mvnrepository.com/artifact/org.projectlombok/lombok -->
            		<dependency>
            		    <groupId>org.projectlombok</groupId>
            		    <artifactId>lombok</artifactId>
            		    <version>1.18.24</version>
            		    <scope>provided</scope>
            		</dependency>
              </dependencies>
            </project>
            ```
            
- ê·œì¹™ì„±
    - ìˆ˜ë™ êµ¬ë™ì˜ í•„ìš”ì„±ì„ ì¤„ì—¬ì¤€ë‹¤.
- ì¢…ì†ì„± ê´€ë¦¬
    - ì¢…ì†ì„±ì„ ì¤‘ì•™ì§‘ì¤‘í™”í•˜ì—¬ ì™¸ë¶€ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‰½ê²Œ ì²˜ë¦¬í•œë‹¤.
- Life cycleê³¼ plug-in
    - í‘œì¤€ ë¹Œë“œ í”„ë¡œì„¸ìŠ¤ë¥¼ ì •ì˜í•˜ê³  í”ŒëŸ¬ê·¸ì¸ì„ í†µí•œ ì‚¬ìš©ì ì •ì˜ë¥¼ í—ˆìš©
- ì „ì´ì  ì¢…ì†ì„± í•´ê²°
    - Mavenì€ ì¢…ì†ì„±ì„ ìë™ìœ¼ë¡œ ê´€ë¦¬í•´ ë³µì¡í•œ ì¢…ì†ì„± ê·¸ë˜í”„ë¥¼ ë‹¨ìˆœí™”í•¨
- í™•ì¥ì„±
    - Mavenì€ í”ŒëŸ¬ê·¸ì¸ì„ í†µí•´ í™•ì¥í•  ìˆ˜ ìˆë‹¤.
    - ê°œë°œìê°€ ì›í™œíˆ ì»¤ìŠ¤í…€í•˜ê³  ë‹¤ë¥¸ ë„êµ¬ì™€ í†µí•©í•  ìˆ˜ ìˆë‹¤.

## â–  Maven ì‚¬ìš©ë²•

- í”„ë¡œì íŠ¸ë¥¼ ìƒì„±í•œë‹¤. Mavenì€ í”„ë¡œì íŠ¸ ë‹¨ìœ„ë¡œ ì ìš©í•  ìˆ˜ ìˆë‹¤.
- í”„ë¡œì íŠ¸ í´ë” ìš°í´ë¦­
- Configure â†’ Convert to Maven Project í´ë¦­
- ìë™ìœ¼ë¡œ Mavenì„ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” í™˜ê²½ìœ¼ë¡œ ì „í™˜ëœë‹¤.
    - Maven Dependencies í´ë”ê°€ ì¶”ê°€ëœë‹¤.
    - Maven Dependencies í´ë” ë‚´ë¶€ì˜ Pom.xmlì„ ìˆ˜ì •í•¨ìœ¼ë¡œì¨ ê°ì¢… í”ŒëŸ¬ê·¸ì¸ì„ ì¶”ê°€, í™•ì¥í•œë‹¤.

# âœ… JDBC

<aside>
ğŸ’¡ **JDBC**
JDBCëŠ” Java ì–´í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ í‘œì¤€í™”ëœ ë°©ë²•ìœ¼ë¡œ ë‹¤ì–‘í•œ DBì— ì ‘ì†í•  ìˆ˜ ìˆê²Œ ì„¤ê³„ëœ API
****ì‰½ê²Œ ë§í•´ Javaì™€ ë°ì´í„°ë² ì´ìŠ¤ ì‚¬ì´ì˜ í†µì—­ê¸°
Java í™˜ê²½ì—ì„œ DBì™€ í†µì‹ í•˜ê³  ì •ë³´ë¥¼ ì–»ê³ , ìˆ˜ì • ë“± ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆê²Œ í•œë‹¤.
ë³´í†µ DBë¥¼ ë§Œë“œëŠ” íšŒì‚¬ì—ì„œ ì§ì ‘ ë°°í¬í•œë‹¤.

</aside>

## â–  JDBCì˜ êµ¬ë™ ìˆœì„œ

1. **Driver Loading**: Class.forName("com.mysql.cj.jdbc.Driver");
2. **Connection**: Connection conn = DriverManager.getConnection(url, id, pw);
3. **Statement**: Statement stmt = conn.createStatement();
4. **query**: String sql = "select * from dept";
5. **run**: ResultSet rs = stmt.executeQuery(sql); // Get, Set, 
6. **close**: rs.close(); / stmt.close(); / conn.close();

- MySQL í™˜ê²½ì—ì„œ JDBCë¡œ ê°„ë‹¨í•˜ê²Œ DB ì¡°íšŒ ë° ìˆ˜ì •í•˜ê¸°
    - **MVC(Model-View-Controller)**
        
        <aside>
        ğŸ’¡ **Model**
        
        - ë°ì´í„°ì™€ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ë‹´ë‹¹
        - DBì™€ì˜ ìƒí˜¸ì‘ìš©, ë°ì´í„°ì˜ ìœ íš¨ì„± ê²€ì‚¬, ê°€ê³µ ë“±ì„ ìˆ˜í–‰
        </aside>
        
        - **Model ì˜ˆì‹œ ì½”ë“œ**
            
            ```java
            **// DeptDto.java**
            **//** 
            package model.domain;
            
            import lombok.AllArgsConstructor;
            import lombok.Getter;
            import lombok.ToString;
            import lombok.*;
            
            //ë°ì´í„° ì „ì†¡ ê³„ì¸µ Data Transfer Operation
            //í´ë˜ìŠ¤ í•˜ë‚˜ì— í…Œì´ë¸” í•˜ë‚˜ë¥¼ ëŒ€ì‘ì‹œì¼œ ì‘ì„±
            // ê° SQL í…Œì´ë¸”ì˜ 'í•„ë“œ'ëŠ” í´ë˜ìŠ¤ì˜ ë©¤ë²„ 'í•„ë“œ'ì™€ ì¼ëŒ€ì¼ ëŒ€ì‘ -> ìë£Œí˜•
            
            @Getter
            @AllArgsConstructor
            @ToString(onlyExplicitlyIncluded = true) 
            public class DeptDto {
            	@ToString.Exclude
            	int deptno;
            	@ToString.Include
            	String dname;
            	String loc;
            	
            }
            ```
            
        
        <aside>
        ğŸ’¡ **View**
        
        - UI(User Interface)ë¥¼ ë‹´ë‹¹
        - ëª¨ë¸ì˜ ë°ì´í„°ë¥¼ ì‹œê°í™”, ì‚¬ìš©ìì™€ì˜ ìƒí˜¸ì‘ìš©
        - ì‚¬ìš©ìì—ê²Œ ì…ì¶œë ¥ ìˆ˜í–‰
        - ëª¨ë¸ì˜ ìƒíƒœë¥¼ ì§ì ‘ ë³€ê²½í•˜ì§€ ì•ŠìŒ
        </aside>
        
        - **View ì˜ˆì‹œ ì½”ë“œ**
            
            ```java
            public static void main(String[] args) {
            			//print() / println() ì°¸ì¡° ë°ì´í„° ì¶œë ¥ ìë™ìœ¼ë¡œ toString() í˜¸ì¶œ 
            			try {
            				//ì •ìƒ ì‹¤í–‰ ë¸Œë¼ìš°ì € ì¶œë ¥ ìœ„ì„(success View)
            				System.out.println("ì •ìƒì¶œë ¥");
            //				System.out.println(selectStep2(10).getDname());
            //				System.out.println(select(10).getDname());
            //				System.out.println(insert(70, "ë§ˆì¼€íŒ…", "New York"));
            				System.out.println("====================");
            				System.out.println(select(40).getLoc());
            //				System.out.println(selectStep2(10).toString());
            			} catch (Exception e) {
            				e.printStackTrace();//ê´€ë¦¬ìë§Œ í™•ì¸ ê°€ëŠ¥í•œ ì½˜ì†” ë©”ì„¸ì§€
            				//fail view
            				//client ë¸Œë¼ìš°ì €ì— ì˜ëª»ëœ ìƒí™©ì„ ì•Œë¦¼ì •ë³´ë¡œ ê°€ê³µí•´ì„œ ë¸Œë¼ìš°ì € ì‹¤í–‰
            				System.out.println("ì˜ëª»ëœ ì •ë³´ë¥¼ ì…ë ¥í•˜ì…¨ìŠµë‹ˆë‹¤");
            			}  
            	}
            ```
            
        
        <aside>
        ğŸ’¡ **Controller**
        
        - ì‚¬ìš©ìì˜ ì…ë ¥ì„ ë°›ì•„ ëª¨ë¸ì„ ì§ì ‘ ì¡°ì‘í•˜ëŠ” ì—­í• 
        - ëª¨ë¸ ë°ì´í„° ê°±ì‹ , ì‚¬ìš©ì ìš”ì²­ì— ë”°ë¼ View ê°±ì‹ 
        - ì „ë°˜ì ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜ íë¦„ ì œì–´
        </aside>
        
        - **Controller ì˜ˆì‹œ ì½”ë“œ**
            
            ```java
            **// Util.java
            // ê±°ì˜ ë§¤ë²ˆ ì‚¬ìš©í•˜ëŠ” í•¨ìˆ˜ë“¤
            // ex. DB ì—°ê²° í•¨ìˆ˜(connection), DB ì—°ê²° ì¢…ë£Œ í•¨ìˆ˜(close)
            package DBUtil;
            
            import java.sql.Connection;
            import java.sql.DriverManager;
            import java.sql.PreparedStatement;
            import java.sql.ResultSet;
            import java.sql.SQLException;
            import java.sql.Statement;
            
            public class Util {
                    static {
                            try {
                            Class.forName("com.mysql.cj.jdbc.Driver");
                            } catch (Exception e) {
                                    e.printStackTrace();//ì˜ˆì™¸ ë°œìƒ ìƒí™©ì„ ë””í…Œì¼í•˜ê²Œ ì¶œë ¥
                            }
                    }
                    
                    // get Connection
                    public static Connection getConnection() throws SQLException{
                            String url = "jdbc:mysql://woori-fisa2.cfnz7hfzq9bn.ap-northeast-2.rds.amazonaws.com/fisa?characterEncoding=UTF-8&serverTimezone=UTC";
                            String id = "admin";
                            String pw = "woorifisa2!";
                            
                            return DriverManager.getConnection(url, id, pw);
                    }
                    
            
                    
                    // close ì „ìš© í•¨ìˆ˜
                    public static void close(Connection conn, Statement stmt, ResultSet rs) throws SQLException{
                            rs.close();
                            stmt.close();
                            conn.close();
                    }
            
                    public static void close(Connection conn, PreparedStatement pstmt)  throws SQLException{
            //                rs.close();
                            pstmt.close();
                            conn.close();
                    }
            }**
            ```
            
            ```java
            **// DataController.java
            // dataì— ì ‘ê·¼í•˜ê³  ì¡°ì‘(CRUD)í•˜ëŠ” ì½”ë“œ ì „ë°˜ í¬í•¨**
            package controller;
            
            import java.sql.Connection;
            import java.sql.PreparedStatement;
            import java.sql.ResultSet;
            import java.sql.Statement;
            
            import DBUtil.Util;
            import model.domain.*;
            
            public class DataController {
            		public static String insert(int deptno, String dname, String loc) throws Exception{
            			Connection conn = null;
            			PreparedStatement pstmt = null;
            			
            			try {
            				conn = Util.getConnection();
            				
            				pstmt = conn.prepareStatement("insert into dept values (?, ?, ?)");
            				
            				pstmt.setInt(1, deptno);
            				pstmt.setString(2, dname);
            				pstmt.setString(3, loc);
            				
            				int result = pstmt.executeUpdate();
            				
            				if(result == 1) {
            					return "ì €ì¥ ì„±ê³µ";
            				}	
            				
            			} catch (Exception e) {
            				e.printStackTrace();
            			} finally { 
            				Util.close(conn, pstmt);
            			}
            			
            			return "ì €ì¥ ì‹¤íŒ¨";
            		}
            		
            		
            		public static DeptDto select(int deptno) throws Exception{
            			Connection conn = null;
            			PreparedStatement pstmt = null;
            			ResultSet rs = null;
            			
            			DeptDto dept = null;	
            			
            			try {
            				conn = Util.getConnection();
            				pstmt = conn.prepareStatement("select * from dept where deptno=?");
            				pstmt.setInt(1, deptno);
            				rs = pstmt.executeQuery();
            				if(rs.next()) {
            					dept = new DeptDto(rs.getInt("deptno"), rs.getString("dname"), rs.getString("loc") ); 
            				}	
            				
            			} catch (Exception e) {
            				e.printStackTrace();
            			} finally { 
            				Util.close(conn, pstmt, rs);
            			}
            			
            			return dept;
            		}
            		
            		
            		public static DeptDto selectStep2(int deptno) throws Exception{
            			
            			Connection conn = null;
            			PreparedStatement pstmt = null;
            			ResultSet rs = null;
            			
            			DeptDto dept = null;	
            			
            			try {
            				conn = Util.getConnection();
            				pstmt = conn.prepareStatement("select * from dept where deptno=?");
            				pstmt.setInt(1, deptno);
            				rs = pstmt.executeQuery();
            				if(rs.next()) {
            					dept = new DeptDto(rs.getInt("deptno"), rs.getString("dname"), rs.getString("loc") ); 
            				}	
            				
            			} finally {  
            				Util.close(conn, pstmt, rs);
            			}
            					
            			return dept;
            		}
            		
            		//ë¶€ì„œëª…ìœ¼ë¡œ ë¶€ì„œ ì •ë³´ ê²€ìƒ‰ localhost/select3?q=Accounting
            		public static DeptDto selectStep3(String dname) throws Exception{
            			
            			Connection conn = null;
            			PreparedStatement pstmt = null;
            			ResultSet rs = null;
            			
            			DeptDto dept = null;	
            			
            			try {
            				conn = Util.getConnection();
            				pstmt = conn.prepareStatement("select * from dept where dname=?");
            				pstmt.setString(1, dname);
            				rs = pstmt.executeQuery();
            				if(rs.next()) {
            					dept = new DeptDto(rs.getInt("deptno"), rs.getString("dname"), rs.getString("loc") ); 
            				}	
            				
            			} finally {  
            				Util.close(conn, pstmt, rs);
            			}
            					
            			return dept;
            		}
            ```
            

# âœ… Lombok

<aside>
ğŸ’¡ **Lombok**
Javaì—ì„œ ë§¤ìš° ìì£¼ ì‚¬ìš©í•˜ëŠ” getter, setter, toString ë“±ì˜ ë©”ì„œë“œë¥¼ ìë™ìœ¼ë¡œ ë§Œë“¤ì–´ì£¼ëŠ” ì½”ë“œ ë‹¤ì´ì–´íŠ¸ ë¼ì´ë¸ŒëŸ¬ë¦¬

</aside>

[Project Lombok](https://projectlombok.org/)

- JDBCì™€ í•¨ê»˜ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
- Model í´ë˜ìŠ¤ì—ì„œ ì•„ë˜ì™€ ê°™ì´ annotationì„ ì¶”ê°€í•´ ì‚¬ìš©í•œë‹¤.
    
    ```java
    @Getter
    @AllArgsConstructor
    @ToString(onlyExplicitlyIncluded = true) 
    public class DeptDto {
    	@ToString.Exclude
    	int deptno;
    	@ToString.Include
    	String dname;
    	String loc;
    }
    ```
    
    - **ìƒì„±ì ê´€ë ¨ annotation**
        - @**NoArgsConstructor**: íŒŒë¼ë¯¸í„°ê°€ ì—†ëŠ” ê¸°ë³¸ ìƒì„±ì
        - @**AllArgsConstructor**: ëª¨ë“  í•„ë“œë¥¼ í¬í•¨í•˜ëŠ” ìƒì„±ì
        - @**RequireArgsConstructor**: final í•„ë“œë§Œ í¬í•¨ëœ ìƒì„±ì
    - **Method annotation**
        - @**Getter**: Getter ìë™ ìƒì„±
        - @**Setter**: Setter ìë™ ìƒì„±
        - @**toString**: toString ìë™ ìƒì„±
            - **toString**(onlyExplicitlyIncluded = true)ë¥¼ í†µí•´ ì•„ë˜ ê¸°ëŠ¥ì„ ì¶”ê°€ ì œê³µ
            - @**toString**.**Include**ê°€ ë¶™ì€ í•„ë“œë§Œ í¬í•¨í•  ìˆ˜ ìˆìŒ
            - @**toString**.**Exclude**ê°€ ë¶™ì€ í•„ë“œë§Œ ì œì™¸í•  ìˆ˜ ìˆìŒ
        - @**EqualsAndHashCode**: equals, hashCode method ìë™ ìƒì„±